import csv
import json
import pandas as pd
import numpy as np
import re
import nltk
import time
import matplotlib.pyplot as plt
from pprint import pprint
from ast import literal_eval
from langdetect import detect_langs
from langdetect import DetectorFactory
DetectorFactory.seed=0

import urlmarker
from html import unescape

p='#\w*|@\w*|('+ urlmarker.ANY_URL_REGEX +')'

tr_lang=['hi','gu','bn','pa','ur','ta','kn','te','ml','mr','ne']

string_loc=r'हिन्दुस्तान|भारत|Prayagraj|Gurugram|banaras|Benares|Calicut|Baroda|Culcutta|Calcutta|Madras|cochin|Bombay|hindustan|India|Bharat|Andhra|Arunachal|Assam|Bihar|Chhattisgarh|Goa|Gujarat|Haryana|Himachal|Jammu|Kashmir|Jharkhand|Karnataka|Kerala|Madhya|Maharashtra|Manipur|Meghalaya|Mizoram|Nagaland|Odisha|Punjab|Rajasthan|Sikkim|Tamil|Telangana|Tripura|Uttar|Uttarakhand|West Bengal|WESTBENGAL|Andaman|Nicobar|Chandigarh|Dadra|Nagar Haveli|Daman|Diu|Lakshadweep|Delhi|Puducherry|NCR|Amravati|Itanagar|Dispur|Patna|Atal Nagar|Raipur|Panaji|Gandhinagar|Ahmedabad|Chandigarh|Shimla|Dharamshala|Srinagar|Ranchi|Bengaluru|bangalore|Thiruvananthapuram|Bhopal|Mumbai|Imphal|Shillong|Aizawl|Kohima|Orissa|Bhubaneswar|Chandigarh|Jaipur|Gangtok|Chennai|Hyderabad|Agartala|Lucknow|Dehradun|Kolkata|Port\sBlair|Silvassa|Kavaratti|Pondicherry|Punch|Ziro|Yol|Yeola|Yavatmal|Yamunanagar|Yadgir|Washim|Warora|Wardha|Warangal|Wankaner|Wandur|Walsang|Wai|Wadgaon|Wada|Vyara|Vuyyuru|Vrindavan|Vriddhachalam|Vizianagaram|Vite|Visnagar|Visakhapatnam|Virpur|Virar|Viramgam|Vinukonda|Villupuram|Villenour|Vikarabad|Vijayawada|Vidisha|Venkatagiri|Vellore|Velapur|Vayalar|Vav|Vashi|Vasco da Gama|Vasai|Vasad|Varkala|Varanasi|Vanur|Vaniyambadi|Vandavasi|Valsad|Vallabh Vidyanagar|Vaikam|Vaijapur|Vadodara|Vadnagar|Vaddem|Vadasinor|Uttarpara|Uttarkashi|Usilampatti|Uran|Uppala|Upleta|Unnao|Unjha|Una|Umreth|Umbraj|Umarkhed|Umaria|Umargam|Uluberiya|Ullal|Ulhasnagar|Ulavapad|Uklana|Ujjain|Udupi|Udhampur|Udgir|Udangudi|Udalguri|Udaipur|Ooty|Turavur|Tura|Tundla|Tumsar|Tumk\xc5\xabr|Tufanganj|Thiruvananthapuram|Triplicane|Thrissur|Tosham|Tonk|Tohana|Todabhim|Tittagudi|Cheyyar|Tiruvannamalai|Tiruvanmiyur|Tiruvallur|Tiruvalla|Thiruthuraipoondi|Thiruthani|Tirur|Tiruppur|Tirupattur|Tirumala - Tirupati|Tirunelveli|Tiruchengode|Tiruchi|Tiruchchendur|Tirap|Tiptur|Tinsukia|Tindivanam|Tijara|Thoubal|Thiruvarur|Thiruvaiyaru|Thanjavur|Thanesar|Thane|Tezpur|Thenkasi|Theni|Thenali|Tellicherry|Tekkali|Tekari|Tehri|Tavarikere|Tarn Taran|Tarikere|Tarapur|Tarakeswar|Taoru|Tanuku|Tanguturu|Tanda|Tanda|Tamulpur|Tamluk|Talwara|Talodhi|Taliparamba|Talikota|Talegaon Dhamdhere|Talegaon Dabhade|Talcher|Tadikonda|Tadepallegudem|Suriapet|Surendranagar|Suratgarh|Surajpur|Surajgarh|Supaul|Sunel|Sundarnagar|Sundargarh|Sunam|Sullia|Ganapathivattam|Sultanpur|Sultanpur|Sukma|Sujangarh|Sudamda|Subulia|Srivilliputhur|Sriperumbudur|Srinivaspur|Srinagar|Srinagar|Karanpur|Srikakulam|Soro|Soreng|Sopur|Sonua|Sonipat|Songadh|Sonepur|Sonari|Sonamura|Sonai|Somvarpet|Solim|Solan|Sojat|Sohna|Sohagpur|Siwana|Siwan|Sivakasi|Sivaganga|Siuri|Sitapur|Sitamau|Sitamarhi|Sisai|Sirsi|Sirsa|Sirohi|Sirkazhi|Sirhind|Sinor|Sinnar|Singur|Singrawat|Singheswar|Sindkhed Raja|Sindewahi|Simrol|Shimla|Silvassa|Silvani|Sillod|Silchar|Silao|Sikar|Sikandrabad|Sihora|Sihor|Sidlaghatta|Sidhi|Siddhapur|Sibsagar|Shujalpur|Serampore|Shrigonda|Sravana Belgola|Shorapur|Shoranur|Sholinghur|Solapur|Shivrajpur|Shirwal|Shirpur|Shirol|Shirdi|Shimoga|Shillong|Siliguri|Shikrapur|Shikohabad|Shevgaon|Sheohar|Shanti Niketan|Shamli|Shamgarh|Shajapur|Shahpura|Shahjahanpur|Shahganj|Shahapur|Shahapur|Shahada|Shahabad|Sewri|Serchhip|Seoraphuli|Seoni Malwa|Seoni|Sengaon|Sendhwa|Sekhwan|Sehore|Secunderabad|Sayalkudi|Sawai Madhopur|Savda|Savantvadi|Sathyamangalam|Satwas|Sattur|Sattenapalle|Satna|Sathiala|Satara|Sasaram|Sasamusa|Sardarshahr|Sarangarh|Saran|Saraipali|Santa Cruz|Sanquelim|Sankhwas|Sankarankovil|Sangrur|Sangola|Sangli|Sangamner|Sancoale|Sanand|Sampla|Sami|Sambhal|Sambalpur|Samba|Samastipur|Samana|Samalkot|Samalkha|Saligrama|Saligao|Salem|Sakri|Sakleshpur|Sainthia|Selu|Sahibganj|Sahibabad|Saharsa|Saharanpur|Sagwara|Saugor|Safipur|Safidon|Sabrum|Sabbavaram|Sabang|Ropar|Rupa|Rudraprayag|Rudauli|Roorkee|Rohtak|Roha|Robertsganj|Risod|Rishra|Rishikesh|Rewari|Rewa|Razole|Rayagada|Raxaul|Rawatsar|Rawatbhata|Raurkela|Ratnagiri|Ratlam|Ratia|Rath|Ratanpura|Rasulpur Rohta|Rasulabad|Rasra|Rasipuram|Rapar|Raniwara|Ranipet|Ranikhet|Raniganj|Ranibennur|Rania|Rani|Rangpo|Rangia|Ranchi|Ranaghat|Ramtek|Rampur|Rampur|Ramnagar|Ramnagar|Ramjibanpur|Ramgarh|Ramgarh|Ramanathpura|Ramanathapuram|Ramachandrapuram|Rajura|Rajula|Rajsamand|Rajpura|Rajpur|Rajpipla|Rajkot|Rajim|Rajgir|Rajgarh|Rajapalaiyam|Rajanagaram|Razampeta|Rajahmundry|Raisinghnagar|Raisen|Raipur|Raipur|Raikot|Raigarh|Raiganj|Raichur|Raia|Rahu|Rahon|Rahimatpur|Rahata|Raghunathpur|Raebareli|Radaur|Kollam|Quepem|Puttur|Pusegaon|Puruliya|Purnia|Puri|Punnapra|Pune|Pundri|Punalur|Pulwama|Pukhrayan|Puduvayal|Pudunagaram|Pudukkottai|Proddatur|Pratapgarh|Pratapgarh|Porumamilla|Port Blair|Porbandar|Ponneri|Ponnani|Ponnampet|Puducherry|Ponda|Pollachi|Polavaram|Pithoragarh|Pithapuram|Piravam|Pirangut|Pipar Road|Pimpri|Pilkhuwa|Pilibangan|Pilani|Piduguralla|Phirangipuram|Phillaur|Phaltan|Phalodi|Phagwara|Phagi|Petlawad|Petlad|Perundurai|Pernem|Perintalmanna|Perambur|Penukonda|Penugonda|Pennadam|Pendra|Pen|Pehowa|Peddapuram|Peddapalli|Pedana|Payyanur|Pauri|Patti|Pattan|Pattambi|Patodi|Patna|Patiala|Pathankot|Pathanamthitta|Pataudi|Patancheru|Patan|Patan|Partur|Parra|Parner|Parli Vaijnath|Parkal|Parbhani|Paravur Tekkumbhagam|Paratwada|Parappanangadi|Paradip|Pappinissheri|Paonta Sahib|Panvel|Pantnagar|Panskura|Panruti|Panipat|Pandua|Pandharpur|French Rocks|Panchgani|Panapakkam|Panjim|Panagarh|Pamgarh|Palwal|Palani|Palladam|Palkonda|Palitana|Palia Kalan|Pali|Pali|Palakkad|Palghar|Palamcottah|Palashi|Palasa|Palanpur|Palampur|Palakollu|Pakyong|Pakala|Padrauna|Padghe|Paderu|Paddhari|Oxel|Owk|Ottappalam|Osmanabad|Orai|Ongole|Olpad|Nuzvid|Nurpur|Nurmahal|Nungambakkam|Nuh|Nowgong|Nohar|Noamundi|Nizamabad|Nirmal|Neemrana|Neem ka Thana|Nimbahera|Nimaparha|Nilokheri|Nilambur|Needamangalam|Nidadavole|Neyveli|New Delhi|Nevasa|Neral|Nepanagar|Nellore|Nayagarh|Nayagaon|Nayagaon|Nawalgarh|Nawada|Nawabganj|Navsari|Navalgund|Nabadwip|Nautanwa|Naugarh|Nathdwara|Nasrapur|Nashik|Narwana|Narsimhapur|Naroda|Narnaul|Narela|Narayangarh|Narayangaon|Narasaraopet|Narasapuram|Narainpur|Napoklu|Nanpara|Nangal|Nandyal|Nandurbar|Nanded|Namli|Namakkal|Nalhati|Nalgonda|Nalbari|Nalagarh|Nakur|Naksalbari|Nakrekal|Nakodar|Najibabad|Najafgarh|Nainital|Nahan|Nagpur|Nagina|Nagercoil|Nagda|Nagaur|Nagapur|Nagapattinam|Nadiad|Nadbai|Nadaun|Nachna|Nabha|Mysore|Muzaffarpur|Muzaffarnagar|Muvattupula|Mustafabad|Mussoorie|Murwara|Murud|Murthal|Murshidabad|Morinda|Murbad|Muradnagar|Munnar|Munger|Mungeli|Mundra|Mundgod|Mundakayam|Mummidivaram|Multai|Mukerian|Mughal Sarai|Mudgere|Mudhol|Mothihari|Morena|Morvi|Morawali|Moranha|Moradabad|Mokokchung|Mokameh|Moirang|Mohanpur|Mohania|Moga|Mirzapur|Miraj|Minjur|Mhow|Merta|Meppadi|Mendhar|Mendarda|Memari|Mehndawal|Mehekar|Meerut|Medinipur|Medchal|Medarametla|Medak|Mayiladuthurai|Mawana|Mavelikara|Mau|Matunga|Mathura|Marwad|Maroli|Mormugao|Markapur|Mariani|Marandahalli|Manteswar|Mansa|Mansa|Manoharpur|Mannargudi|Manjeri|Manipal|Mangaon|Mangan|Mangalore|Mangalagiri|Mandya|Mandvi|Mandsaur|Mandla|Mandi|Mandapeta|Mandal|Manda|Mancherial|Manchar|Manawar|Manavadar|Manapparai|Manantoddy|Manamadurai|Manali|Malvan|Malur|Malpura|Malpur|Malkapur|Maler Kotla|Malegaon|Malda|Malappuram|Mala|Makrana|Mairang|Mainpuri|Mahuva|Mahroni|Mahishadal|Mahim|Mahesana|Mahendragarh|Mahemdavad|Mahe|Maharaganj|Mahalingpur|Mahad|Mahabaleshwar|Maghar|Magadi|Madurai|Chennai|Madkai|Madikeri|Madhyamgram|Madhupur|Madhubani|Madhoganj|Madh|Madgaon|Maddur|Madanapalle|Madakasira|Machilipatnam|Macherla|Lunglei|Ludhiana|Lucknow|Luckeesarai|Lotan|Loni Kalbhor|Lonavla|Lohaghat|Lingsugur|Lingal|Leh|Lawngtlai|Latur|Latipur|Lalsot|Lalitpur|Lalgola|Lalganj|Lakhimpur|Lahli|Ladwa|Ladnun|Kuzhithurai|Kuttippuram|Kutiatodu|Kushtagi|Kushalnagar|Kurud|Kurnool|Kurkhera|Kurali|Kuppam|Kunnamkulam|Kunigal|Kumharsain|Kumbakonam|Kumarkera|Kulpahar|Kulgam|Kulasegaram|Kukshi|Kudal|Kuchaman|Krishnanagar|Krishnai|Krishnagiri|Kozhikode|Koyyalagudem|Kovvur|Kovilpatti|Kotul|Kottayam|Kottarakara|Kottakkal|Kottagudem|Kotputli|Kotma|Kothamba|Kotdwara|Kotagiri|Kota|Kosli|Kosamri|Kosamba|Korea|Korba|Koraput|Koppal|Konnagar|Kondotty|Konch|Komarolu|Kolhapur|Kolar|Colachel|Kohima|Kodungallur|Kodinar|Kodaikanal|Koch Bihar|Kizhake Chalakudi|Kittur|Kishtwar|Kishangarh|Kishanganj|Kishanganj|Ulundurpet|Kiliyanur|Kichha|Khurja|Khurda|Khurai|Khowai|Khopoli|Khimsar|Khilchipur|Khetri|Kheralu|Khedbrahma|Kheda|Khed|Khategaon|Khatauli|Khargone|Khardaha|Kharar|Kharagpur|Khanpur|Khanna|Khandwa|Khandagiri|Khammam|Khambhat|Khambhaliya|Khamanon Kalan|Khalilabad|Khalapur|Khairagarh|Khagaria|Khaga|Khachrod|Keonjhargarh|Kendraparha|Kembhavi|Kelambakkam|Kekri|Kayamkulam|Kayalpattinam|Kawardha|Kavaratti|Kavali|Katoya|Katol|Katihar|Kathua|Kasibugga|Kasia|Kashipur|Kasganj|Kasaragod|Kasara|Karwar|Karur|Kartarpur|Karsiyang|Karong|Karnal|Karmala|Karkala|Karjat|Karimpur|Karimnagar|Karimganj|Kareli|Karedu|Karauli|Karandighi|Karamsad|Karaikudi|Karaikal|Karad|Kapurthala Town|Kapadvanj|Kanwat|Kanpur|Kannod|Kanniyakumari|Kannavam|Kannauj|Kanhangad|Kankipadu|Kankinara|Kanker|Kankauli|Kaniyambetta|Kanigiri|Kangar|Kangayam|Kandukur|Kandi|Kanchipuram|Kankanhalli|Kamuthi|Kaman|Kalyani|Kalyan|Kalva|Kalpatta|Kalpakkam|Kalol|Kalna|Kanina Khas|Kalimpong|Kalavad|Kalasa|Kalanwali|Kalanaur|Kala Amb|Kakkad|Kakinada|Kakdwip|Kakatpur|Kaithal|Kailashahar|Kagal|Kadur|Kadiri|Kadi|Kadegaon|Kadakola|Kadayanallur|Kanchrapara|Jundla|Junagadh|Jumri Tilaiya|Jalandhar|Jugsalai|Jowai|Joshimath|Jorhat|Jogbani|Jodhpur|Jobat|Jind|Jigani|Jiaganj|Jhusi|Jhunjhunun|Jhinjhak|Jharsuguda|Jhargram|Jhansi|Jhalrapatan|Jhalawar|Jhajjar|Jhabua|Jetpur|Jeypore|Jaynagar|Iawar|Javagallu|Jaunpur|Jatani|Jasrana|Jashpurnagar|Jasdan|Jarod|Jaora|Janjgir|Jangipara|Janephal|Jandiala Guru|Jamshedpur|Jamner|Jamnagar|Jammu|Jambusar|Jamalpur|Jalpaiguri|Jalor|Jalna|Jalgaon Jamod|Jalaun|Jalalpur|Jalalabad|Jajpur|Jaitaran|Jaisingpur|Jaisalmer|Jaipur|Jaijaipur|Jagraon|Jaggampeta|Jagdalpur|Jagatsinghapur|Jagalur|Jagadhri|Jayal|Jadla|Jabalpur|Itwa|Itarsi|Itanagar|Ismailabad|Islampur|Islampur|Iritty|Irinjalakuda|Indore|Indi|Indapur|Imphal|Ikauna|Iglas|Igatpuri|Idukki|Idar|Ichalkaranji|Hyderabad|Hura|Hugli|Hubli|Hosur|Hospet|Hoskote|Hoshiarpur|Hoshangabad|Honnali|Honavar|Hodal|Hisar|Hirisave|Hiranpur|Hirakud|Hingoli|Hinganghat|Hindupur|Hindaun|Himatnagar|Hilsa|Hazaribagh|Haveri|Hathras|Hata|Hassan|Harur|Harsol|Harpalpur|Harohalli|Harnaut|Haripad|Hariharganj|Harihar|Haridwar|Harda|Hapur|Howrah|Hanumangarh|Hansi|Hanamkonda|Hamirpur|Hamirpur|Halvad|Halol|Haldwani|Hajipur|Hajipur|Haflong|Habra|Gyanpur|Gwalior|Guskhara|Guruvayur|Gurmatkal|Gurgaon|Gurdaspur|Guntur|Guntakal|Guna|Gummidipundi|Gulbarga|Gulabpura|Guindy|Guhagar|Gudur|Gudluru|Gudivada|Gotan|Goregaon|Gorantla|Gorakhpur|Gobichettipalayam|Gopalpur|Gopalganj|Gopalapuram|Gooty|Gondia|Gondal|Gonda City|Gola Gokarannath|Golaghat|Gola Bazar|Gokavaram|Gokak|Gohpur|Gohana|Goh|Godhra|Godda|Goalpara|Giridih|Gingee|Ghosi|Ghorawal|Ghazipur|Ghaziabad|Ghatkopar|Ghatal|Ghat|Gaya|Goribidnur|Guwahati|Garli|Garhshankar|Gannavaram|Gangtok|Gangrar|Gangarampur|Ganganagar|Gandhinagar|Gandhidham|Gandevi|Gandarbal|Gandai|Gampalagudem|Gajwel|Gajraula|Gadwal|Gadhinglaj|Gadarwara|Firozpur|Firozabad|Fazilka|Fatehpur|Fatehgarh|Fatehabad|Farrukhabad|Faridkot|Faridabad|Farakka|Faizabad|Etawah|Etah|Erode|Ernakulam|Eraniel|Ellore|Ellenabad|Ekangar Sarai|Egra|Egmore|Edavanna|Edappal|Edappalli|Dwarka|Durgapur|Durg|Dungarpur|Dundlod|Dumka|Dubrajpur|Dubari|Doraha|Dongargaon|Dona Paula|Dombivali|Doda|Diva|Diu|Dispur|Dirba|Diphu|Dinhata|Dindigul|Dinanagar|Dimapur|Dighwara|Digha|Didwana|Dicholi|Dibrugarh|Diamond Harbour|Dhuri|Dhupgari|Dhule|Dhrangadhra|Dholka|Dhenkanal|Dhemaji|Dhaulpur|Dharwad|Dharuhera|Dharamsala|Dharmavaram|Dharmastala|Dharmapuri|Dharmanagar|Dharmajigudem|Dharmaj|Dhariwal|Dhari|Dharavi|Dharangaon|Dharampur|Dhar|Dhansura|Dhankoli|Dhanera|Dhandhuka|Dhanbad|Dhamtari|Dhampur|Dewas|Devgarh|Desuri|Deoria|Deori|Deolia|Deoli|Deoghar|Deogarh|Deoband|Delhi|Delang|Dehri|Dehra Dun|Degana|Davangere|Dausa|Daurala|Daund|Daudnagar|Dasuya|Daspur|Dasave|Darsi|Darjeeling|Darbhanga|Dapoli|Dankaur|Dandeli|Dinapore|Damoh|Daman|Dalgaon|Dohad|Dahegam|Dahanu|Dadri|Dadra|Dabra|Dabhoi|Cuttack|Curchorem|Cuncolim|Cumbum|Kadapa|Cuddalore|Cossipore|Coonoor|Coondapoor|Colva|Colovale|Calangute|Coimbatore|Kochi|Cinnamara|Churu|Churachandpur|Vikasnagar|Chotila|Choranda|Rampachodavaram|Chittoor|Chittaurgarh|Chittaranjan|Chitradurga|Chidawa|Chirala|Chiplun|Chinturu|Chintalapudi|Chinna Ganjam|Chinchvad|Chinchpokli|Chincholi|Chillupar|Chikodi|Chikmagal\xc5\xabr|Chikhli|Chikhli|Chidambaram|Chicalim|Chhota Udepur|Chhindwara|Chhatarpur|Chapra|Chetput|Chetput|Chengannur|Chengam|Chengalpattu|Chavara|Chetwayi|Chaupal|Chaksu|Chatra|Chas|Charkhi Dadri|Channarayapatna|Channapatna|Changanacheri|Chanda|Chandrakona|Chandpur|Chandil|Chandigarh|Chandbali|Chanduasi|Chandauli|Chandannagar|Chamundi|Champawat|Champahati|Champadanga|Champa|Chamba|Chalsa|Challakere|Chalisgaon|Chakradharpur|Chakan|Carapur|Canning|Kannur|Candolim|Kolkata|Byadgi|Buxar|Burhar|Bundi|Buldana|Bulandshahr|Budhlada|Budhana|Budbud|Budaun|Bramhapuri|Brajarajnagar|Brahmapur|Botad|Borsad|Bori|Barwas|Bongaigaon|Bomdila|Mumbai|Bolpur|Bokaro Steel City|Bokajan|Boisar|Bobbili|Bishnupur|Bisalpur|Beed|Binnaguri|Bilimora|Bilga|Bilaspur|Bilaspur|Bilaspur|Bilaspur|Bilara|Bilaigarh|Bikaner|Bijapur|Bihta|Bihar Sharif|Bihariganj|Bidasar|Bidar|Bhusaval|Bhurkunda|Bhuj|Bhubaneswar|Bhopal|Bhongir|Bhulath Gharbi|Bhokar|Bhojpur Kadim|Bhiwani|Bhiwandi|Bhinmal|Bhimpur|Bhimavaram|Bhimadolu|Bhilwara|Bhiloda|Bhilai|Bhayandar|Bhawanipur|Bhawanipatna|Bhawanigarh|Bhavnagar|Bhavani|Bhattu Khurd|Bathinda|Bhatgaon|Bhatapara|Bharwari|Bharuch|Bharatpur|Bhanvad|Bhandara|Bhaisa|Bhagwanpur|Bhagalpur|Bhagabanpur|Bhadreswar|Bhadravati|Bhadran|Bhadrakh|Bhadra|Bhadohi|Bhadaur|Bhachau|Bhabhar|Beypore|Betul|Bettiah|Betma|Beniganj|Benaulim|Bemetara|Bellary|Belgharia|Belgaum|Beldanga|Belda|Behror|Begusarai|Begunia|Begowal|Bedradka|Beawar|Bazpur|Bayad|Bawal|Batgaon|Batala|Basudebpur|Basti|Bastar|Bassi|Basna|Basmat|Basirhat|Basi|Basanti|Barwani|Barwala|Barwah|Baruipur|Barpeta|Barotha|Baroni|Barnala|Barnagar|Barmer|Baripada|Barhni|Barharwa|Bargarh|Baraily|Bareilly|Bardoli|Barddhaman|Bardar|Baraut|Barasat|Baranagar|Baran|Baramula|Baramati|Barakpur|Barakatha|Baragaon|Bapatla|Banur|Banswara|Bansur|Bansi|Bansbaria|Bankura|Banki|Banka|Banjar|Bangarapet|Bangaon|Bengaluru|Banga|Banethi|Bandikui|Banda|Banda|Balurghat|Balu|Balrampur|Balotra|Balod|Ballygunge|Ballia|Ballia|Ballarpur|Ballabgarh|Balasore|Balehonnur|Balarampur|Balangir|Balanagar|Balaghat|Bakhtiyarpur|Bakhri|Bakani|Baijnath|Baihar|Bahraich|Baharampur|Bahadurgarh|Bagrian|Bagicha|Bagpat|Bagdogra|Bagha Purana|Bageshwar|Bagalkot|Badlapur|Badlapur|Badikata|Badarpur|Badami|Bachai|Baberu|Azimganj|Azamgarh|Ayodhya|Avanigadda|Avadi|Aurangabad|Attur|Attingal|Atru|Atmakur|Adirampattinam|Athani|Ateli Mandi|Assagao|Ashta|Ashoknagar|Asansol|Asangaon|Arwal|Arvi|Arsikere|Aron|Arni|Arkalgud|Arjuni|Arjuni|Ariyalur|Ardi|Araria|Arni|Arambol|Arambagh|Arakkonam|Arrah|Anupgarh|Annavaram|Annamalainagar|Ankleshwar|Anjuna|Anjar|Angul|Angamali|Angadipram|Anthiyur|Andheri|Anchal|Anavatti|Anantnag|Anantapur|Anandpur|Anand|Anakapalle|Amta|Amroli|Amroha|Amritsar|Amreli|Amravati|Amod|Ammapettai|Amloh|Amla|Amguri|Amethi|Amet|Ambur|Amboli|Ambikapur|Ambheti|Ambelim|Ambaulim|Ambattur|Ambasamudram|Ambalapuzha|Ambala|Ambajogai|Amba|Amauli|Ambarnath|Amarkantak|Amalner|Amalapuram|Alwar|Almora|Allur|Allinagaram|Alappuzha|Allahabad|Allagadda|Alipur|Aligarh|Aliganj|Alibag|Aldur|Aldona|Alawalpur|Alangulam|Alangudi|Alandurai|Alandi|Alamuru|Akot|Akola|Akkihebbal|Akividu|Akhegwo|Akbarpur|Akalgarh|Ajmer|Aizawl|Ahmadpur|Ahmednagar|Ahmedabad|Agroha|Agra|Agolai|Agartala|Agaram|Afzalgarh|Adyar|Adoni|Adki|Adilabad|Addanki|Adavad|Achampet|Abu Road|Mount Abu|Abohar|Abhona|Abhayapuri|Dalli Rajhara|Bhanupratappur|Contai|Haldia|Baikunthapur|Haripal|Champdani|Begampur|Basantapur|Chanditala|Sahapur|Amtala|Gazipur|Gujrat|Chakdaha|Bhabanipur|Chandpur|Narayanpur|Amratala|Haryana|Satwari|Rudarpur|Badripur|Bhagwanpur|Sherpur|Weir|Alipura|Kair|Bar|Amsaur|Shadnagar|Kanaiguda|Kapra|Dacharam|Dharmaram|Narsapur|Vadigenhalli|Beas|Thirumangalam|Erukkancheri|Porur|Vadapalani|Raja Annamalaipuram|Choolai|Royapettah|Anna Nagar|Perungudi|Ashok Nagar|Nandanam|Siruseri|Nandambakkam|Pennalur|Gunduperumbedu|Kupw\xc4\x81ra|Gadu|Mithoi|Auroville|Puttaparthi|Panchkula|Dehradun|Greater Noida|Rupana|Badla|Model Town|Gora|Dhajrai|Jamrar|Mohali|Gurgaon|Abdullapur|Mahapura|Basantpur|Aurangabad|Aluva|Muvattupuzha|Perumbavoor|Vapi|Baddi|Noida|Bhiwadi|Jorethang|Mandideep|Singrauli|Kachiguda|Madhira|Malkajgiri|Manuguru|Palwancha|Sathupalli|Naharlagun|Lumding Railway Colony|Banjara Hills|Ambalavayal|Zira|Aur|Tharamani|Kutta|Jubilee Hills|Chendamangalam|Thuraiyur|Udaipurwati|Ramagundam|Ravulapalem|Shiruru|Biswanath Chariali|Kirandul|Adivarampet|Thoothukudi|Haroa|Keshiary|Nagrota Surian|Chandahandi|Kheroni|Bihpuria|Kurukshetra|Bagrakote|Banarhat|Joda|Khawzawl|Thodupuzha|Purnea|Srikalahasti|Nedumkandam|Bathuni|Badian|Chomu|Jagitial|Anhai|Morshi|Anand Parbat|Andana|Himmatnagar|Mallampet|Marhowrah|Lalru|Sawantwadi|Bhuna|Allapur|Abhangapur|Pulimamidi|Jinnaram|Ibrahimpatnam|Medipalli|Manikonda|Gajulpet|Kataram|Sawaigudem|Alwal|Appajipet|Uppugal|Addagudur|Amberpet|Kadipikonda|Subedari|Ramchandrapuram|Maheshwaram|Ballepalli|Madannapet|Bojannapet|Bangarigadda|Desaiganj|Domadugu|Chandanagar|Kokapet|Gaganpahad|Kismatpur|Attapur|Hyderguda|Barkas|Uppuguda|Yakutpura|Abids|Mehdipatnam|Tolichowki|Erragadda|Somajiguda|Shantinagar|Khairatabad|Nehrunagar|Prakashamnagar|Badepalli|Shamirpet|Chitakodur|Dubbak|Chittapur|Kurella|Suraram|Chippalapalli|Gopiganj|Arjunamau|Bamhrauli|Rudraram|Wadiaram|Metpalli|Aroor|Ravangla|Amahia|Bakuliha|Damtal|Basarke|Amaura|Goraya|Baroti|Allachaur|Beral|Kumbh|Patran|Sangria|Bhadravaram|Chintaluru|Aswapuram|Sarapaka|Rajam|Anigandlapadu|Nuapada|Kuchipudi|Nallakunta|Chennapur|Tallapudi|Akkampeta|Cherthala|Dudhathal|Babrol|Falna|Gadarpur|Betalghat|Annavarappadu|Harkadi|Channahalli|Karpe|Barebettu|Kuvettu|Bettadapura|Jandaha|Harapanahalli|Chiduravalli|Gattepalli|Ankireddipalli|Ramannapet|Bamroda|Changaramkulam|Kothamangalam|Edakkara|Belampalli|Mallial|Bittangala|Gonikoppal|Kalladka|Anegundi|Maslandapur|Kothapalli|Adraspalli|Malakpet|Tarnaka|Bodupal|Almasguda|Champapet|Elappara|Ambajipeta|Ammavarikuppam|Anaparthy|Savarkundla|Nirjuli|Chevitikallu|Hindmotor|Hridaypur|I.Polavaram|Kalpeni|Kannamangalam|Karthikappally|Kolaghat|Kolenchery|Kumarghat|Marthandam|Vemulapally|Erumely|Bandrevu|Alathur|Dharmanallur|Parukkal|Kakkalani|Aliyanilai|Mandapasalai|Kattikulam|Kallankattuvalasu|Kumulam|Elleri|Koppampatti|Baidmara|Kalahandi|Jiribam|Bhupalpally|Shahdara'


string_tags=r'ElectionResults2019|Verdict2019|ModiAaRahaHai|ABPresults2019|AcceptTheVerdict|Modi|Rahul|mahagathbandhan|Namo|Pappu|Mamta|Mamata|Indian\sElection|trinamool|Bhakt|chokidar|pradhan|Narendra|ModiGoBack|Congress|AAP|(\W|\b)SP(\W|\b)|BSP|TMC|NDA|UPA|BJP|SPlos|SPwin|SPwon|Lok\sSabha|Loksabha|Rajya\sSabha|RajyaSabha|mayawati|chandrababu|naidu|Akhilesh|Jaitley|kejriwal|asaduddin|owaisi|gehlot|yeddyurappa|smriti|Maneka|Amethi|sambit|subramanian|Digvijaya|Kanhaiya|Harsh\sVardhan|Kumaraswamy|Hardik\sPatel|Advani|Manmohan|Mulayam|Mehbooba\sMufti|Gadkari|nitish|navjot|sidhu|lalu|Omar\sAbdullah|Chidambaram|Thackeray|Rajnath|Paswan|Tharoor|Shatrughan|Ghulam\sNabi|vasundhara|adityanath|VKSingh' 

string_remove=r'theresa|brexit|donald|trump|kuenssberg|(\W|\b)USA(\W|\b)|(\W|\b)EU(\W|\b)|Europe|america|UK|Britain|washington|london|republican|texas|ActOnClimate|LeadOnClimate|McCabe|Comey|Mueller|senate|senator|Uncle\sTom|Civil\sWar|Singapore|Library\sof\sCongress|Democrats|(\W|\b)Democrat(\W|\b)|ClimateChange|United States|FridayThoughts|instagram|instagood|(\W|\b)potus(\W|\b)|Corbyn|McConnell'

###########################################################################################################################################
def fun_loc(arg):
    r2=False
    loc=arg['location']
    pl=arg['place']
    if re.search(string_loc,loc, re.IGNORECASE)!=None or re.search(r'(\W|\b)India(\W|\b)|हिन्दुस्तान|भारत',pl,re.IGNORECASE)!=None: 
        #if location is desirable then check if it needs translation

            a=0
            b=len(arg['text'])-1
            if arg['display_text_range']!=None:
                a=arg['display_text_range'][0]
                b=arg['display_text_range'][1]
           
            try:
                d=detect_langs(arg['text'][a:b])#obtain list of possible languages in d
            except:
                return False , None #if detect_langs() is throwing exception then it means that tweet is useless , it either contains only                                     #simileys, or only a link (a shared tweet) or a language which can't be understood
                                    #so for such tweets we return false even if location is desireable
            
            for el in d:#among detected langs , check if anyone of them matches with desired langs
                if el.lang in tr_lang:
                    r2=True
                    break
            return True,r2        
    return False,None


###########################################################################################################################################
    
def fun_text(arg):
    
    r1=False#r1 is for saving tweet and r2 is for marking translate field
    r2=False
    a=0
    b=len(arg['text'])-1
    if arg['display_text_range']!=None:
        a=arg['display_text_range'][0]
        b=arg['display_text_range'][1]
          
    try:
        d=detect_langs(arg['text'][a:b])#obtain list of possible languages in d
    except:
        return False , None
    
    for el in d:#among detected langs , check if anyone of them matches with desired langs
                
        if el.lang=='en':#compare against tags only if language is english
            if arg.full_text==None:#if non-truncated tweet
                if re.search(string_tags,arg['text'],re.IGNORECASE)!=None: #if text has a desirable tag
                    r1=True
            else:#if truncated tweet
                if re.search(string_tags,arg['full_text'],re.IGNORECASE)!=None:#if full_text has a desirable tag
                    r1=True
            
                    
        if el.lang in tr_lang:
            r1=True
            r2=True
            break
        
    if r1==False:#lang was neither english nor regional
        return False,None
    else:
        return r1,r2
    
    
###########################################################################################################################################
        
def fun_foreign(arg):
    if arg['translate']==True:#if lang is regional
        return True
    else:#if lang is english
        if arg.full_text==None:#if non-truncated tweet
                if re.search(string_remove,arg['text'],re.IGNORECASE)!=None: #if text has foreign tag
                    return False
        else:#if truncated tweet
                if re.search(string_remove,arg['full_text'],re.IGNORECASE)!=None:#if full_text has foreign tag
                    return False
        return True
        
########################################################################################################################################### 
        
def f_clean1(arg):
    if arg.full_text==None:
        s=unescape(arg['text'])
    else:
        s=unescape(arg['full_text'])
             
    s=re.sub(p,'',s) #removing mentions, hashtag strings and urls from tweets   
    return s